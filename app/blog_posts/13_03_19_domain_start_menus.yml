title: "Domain Start Menus"
body: "Over at [url=http://www.ed-itsolutions.com]Ed-IT Solutions[/url] we have been looking at ways to make the user experiance nicer for the users in our schools and we have set our sights on the start menu. Problems arise when software runs from a network share so is never installed on the computer which means that the only shortcut to it is the one we place on the desktop. The problem with relying on desktop shortcuts is that there is a point when the desktop stops looking neat and tidy and becomes a huge mess with the shortcuts hidden in sub folders, a problem fixed by the search bar at the bottom of the start menu.\r\n\r\n
If we where to redirect the start menu to the server things would messy very quickly as our folders merged with the ones already there so our only option is to hide the \"common items\" and blank the menu entirely. This opens up a new problem, if the network goes down or has issues whilst users are logged in they will have no start menu, possibly even errors if they try to open it. So the only option we had was to copy the start menu to the local machine and redirect to that.\r\n\r\n
We then decided to address another problem we have with desktops, dead shortcuts. This became a huge problem when we had Windows 7 x64 and Windows XP on the same domain and the last thing we wanted was broken shortcuts in the start menu, so we decided to make the script make sure that any shortcuts would work on that computer.\r\n\r\n
The end result of all this thinking is [url]https://github.com/Ed-ITSolutions/DomainStartMenu[/url]. These scripts don't supply all the functionality by themselves, to get it working exactly as we wanted we needed to make some changes via a GPO, the GPO needs to do a few things...\r\n\r\n
[b]1. Create a Scheduled Task to run the Script on Logon[/b]\r\nI hear you shouting \"But group policy has a logon scripts section, why aren't you using that?\", the answer is pretty simple. Logon scripts run as the user logging in which means that the start menu would be created and owned by the first user to login. The easiest solution to this is to have the script run by the same user every time which can be easily achived by creating a scheduled task triggered by any user logging in to run the script.\r\n\r\n
[b]2. Redirect the Start Menu to the target folder[/b]\r\nThis is pretty obvious, redirect the start menu to the folder created by the script. Just make sure that you turn off \"Grant Exclusive Rights...\" and \"Move contents...\"\r\n\r\n
[b]3. Hide common Items[/b]\r\nThis is optional but turning it on results on the best looking start menu possible. If you turn this on your shortcuts will be the only ones the user gets so make sure you put things like IE and accessories back in.\r\n\r\n
The result of this is a nice looking start menu that has shortcuts to all your software (even web based software) which is fully searchable.\r\n\r\n
As we deploy this in more schools and come up with more improvements they will be added to the git repo so keep checking back there!"
summary: "With software running from network shares and other network based software titles the start menu can end up with half the software and lots of shortcuts restricted users can't use. We have written a script to combat this!"
date: "19<sup>th</sup> March 2013"